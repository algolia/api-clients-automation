searchResultsItem:
  allOf:
    - $ref: '../../../../../common/schemas/SearchResponse.yml#/baseSearchResponse'
    - $ref: '#/SearchPagination'
    - $ref: '#/searchHits'
    - $ref: '#/resultsCompositionsResponse'

SearchPagination:
  type: object
  additionalProperties: false
  properties:
    page:
      type: integer
      description: The current page of the results.
      example: 0
    nbHits:
      type: integer
      description: Number of results (hits).
      example: 20
    nbPages:
      type: integer
      description: Number of pages of results.
      example: 1
    hitsPerPage:
      type: integer
      description: Number of hits returned per page.
      example: 20
  required:
    - page
    - nbHits
    - nbPages
    - hitsPerPage

searchHits:
  type: object
  additionalProperties: true
  properties:
    hits:
      type: array
      description: |
        Search results (hits).

        Hits are records from your index that match the search criteria, augmented with additional attributes, such as, for highlighting.
      items:
        $ref: 'Hit.yml#/hit'
    query:
      type: string
      description: The search query string.
      example: shoes
    params:
      type: string
      description: URL-encoded string of all search parameters.
      example: query=a&hitsPerPage=20
  required:
    - hits
    - query
    - params

resultsCompositionsResponse:
  type: object
  additionalProperties: true
  properties:
    compositions:
      title: resultsCompositionsInfoResponse
      type: object
      additionalProperties:
        title: resultsCompositionInfoResponse
        x-additionalPropertiesName: composition-id
        type: object
        properties:
          injectedItems:
            type: array
            items:
              $ref: '#/resultsInjectedItemInfoResponse'
        required:
          - injectedItems
  required:
    - compositions

resultsInjectedItemInfoResponse:
  type: object
  additionalProperties: true
  properties:
    key:
      type: string
    appliedRules:
      type: array
      items:
        title: resultsInjectedItemAppliedRulesInfoResponse
        type: object
        properties:
          objectID:
            $ref: '../../../../../common/parameters.yml#/objectID'
        required:
          - objectID
  required:
    - key