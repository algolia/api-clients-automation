<?php

require __DIR__.'/../vendor/autoload.php';
{{> snippets/import}}

$getGoogleAnalyticsUserIdFromBrowserCookie = function (string $cookieName): string {
    // Implement your logic here
    return '';
};

try {
  {{> snippets/init}}

  $userToken = $getGoogleAnalyticsUserIdFromBrowserCookie('_ga');
  $searchParams = [
    'query' => '<YOUR_SEARCH_QUERY>',
    'userToken' => $userToken,
  ];

  {{#dynamicSnippet}}searchWithSearchParams{{/dynamicSnippet}};

  /** @var string|null $loggedInUser */
  $loggedInUser = null;

  $searchParams['userToken'] = $loggedInUser ?? $userToken;

  {{#dynamicSnippet}}searchWithSearchParams{{/dynamicSnippet}};
} catch (Exception $e) {
  echo $e->getMessage() . PHP_EOL;
}