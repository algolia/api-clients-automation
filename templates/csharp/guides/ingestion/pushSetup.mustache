namespace Algolia;

using System;
using System.Text.Json;
using System.Collections.Generic;

{{> snippets/import}}

using Action = Algolia.Search.Models.Ingestion.Action;

class PushSetup
{
    async Task Main(string[] args)
    {
      try
      {
        var jsonContent = await File.ReadAllTextAsync("records.json");

        var records = JsonSerializer.Deserialize<List<PushTaskRecords>>(jsonContent);

        // use the region matching your applicationID
        {{> snippets/init}}

        // setting `watch` to `true` will make the call synchronous
        var resp = {{#dynamicSnippet}}pushSetup{{/dynamicSnippet}};

        Console.WriteLine(resp);
      }
      catch (Exception e)
      {
          Console.WriteLine(e.Message);
      }
    }
}