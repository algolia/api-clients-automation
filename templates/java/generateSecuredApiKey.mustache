String queryStr = QueryStringUtils.buildRestrictionQueryString(restriction);
Mac hmac = Mac.getInstance("HmacSHA256");
hmac.init(new SecretKeySpec(privateApiKey.getBytes(), "HmacSHA256"));
byte[] rawHmac = hmac.doFinal(queryStr.getBytes());
StringBuilder sb = new StringBuilder(rawHmac.length * 2);
for (byte b : rawHmac) {
  sb.append(String.format("%02x", b & 0xff));
}
String key = sb.toString();

return new String(Base64.getEncoder().encode(String.format("%s%s", key, queryStr).getBytes(Charset.forName("UTF8"))));
