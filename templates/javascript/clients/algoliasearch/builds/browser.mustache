// {{{generationBanner}}}

import type { InitClientOptions, InitClientRegion } from "./models"

{{> algoliasearch/builds/definition}}
  {{> algoliasearch/builds/initClients}}

  return {
    ...searchClient(appId, apiKey, {
      timeouts: {
        connect: DEFAULT_CONNECT_TIMEOUT_BROWSER,
        read: DEFAULT_READ_TIMEOUT_BROWSER,
        write: DEFAULT_WRITE_TIMEOUT_BROWSER,
      },
      requester: createXhrRequester(),
      algoliaAgents: [{ segment: 'Browser' }],
      authMode: 'WithinQueryParameters',
      responsesCache: createMemoryCache(),
      requestsCache: createMemoryCache({ serializable: false }),
      hostsCache: createFallbackableCache({
        caches: [
          createBrowserLocalStorageCache({ key: `${apiClientVersion}-${appId}` }),
          createMemoryCache(),
        ],
      }),
      ...options,
      }),
    /**
     * Get the value of the `algoliaAgent`, used by our libraries internally and telemetry system.
     */
    get _ua(): string {
      return this.transporter.algoliaAgent.value;
    },
    initAbtesting,
    initAnalytics,
    initPersonalization,
    initRecommend,
  };
}