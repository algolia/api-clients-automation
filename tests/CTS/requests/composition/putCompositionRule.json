[
  {
    "parameters": {
      "compositionID": "compositionID",
      "objectID": "ruleID",
      "compositionRule": {
        "objectID": "ruleID",
        "conditions": [
          {
            "anchoring": "is",
            "pattern": "test"
          }
        ],
        "consequence": {
          "behavior": {
            "injection": {
              "main": {
                "source": {
                  "search": {
                    "index": "foo"
                  }
                }
              },
              "injectedItems": [
                {
                  "key": "my-unique-group-from-rule-key",
                  "source": {
                    "search": {
                      "index": "foo"
                    }
                  },
                  "position": 2,
                  "length": 1
                }
              ]
            }
          }
        }
      }
    },
    "request": {
      "path": "/1/compositions/compositionID/rules/ruleID",
      "method": "PUT",
      "body": {
        "objectID": "ruleID",
        "conditions": [
          {
            "anchoring": "is",
            "pattern": "test"
          }
        ],
        "consequence": {
          "behavior": {
            "injection": {
              "main": {
                "source": {
                  "search": {
                    "index": "foo"
                  }
                }
              },
              "injectedItems": [
                {
                  "key": "my-unique-group-from-rule-key",
                  "source": {
                    "search": {
                      "index": "foo"
                    }
                  },
                  "position": 2,
                  "length": 1
                }
              ]
            }
          }
        }
      }
    }
  },
  {
    "skipLanguages": ["kotlin"],
    "parameters": {
      "compositionID": "compositionID",
      "objectID": "rule-with-metadata",
      "compositionRule": {
        "objectID": "rule-with-metadata",
        "conditions": [
          {
            "anchoring": "is",
            "pattern": "test"
          }
        ],
        "consequence": {
          "behavior": {
            "injection": {
              "main": {
                "source": {
                  "search": {
                    "index": "foo"
                  }
                }
              },
              "injectedItems": [
                {
                  "key": "my-unique-group-from-rule-key",
                  "source": {
                    "search": {
                      "index": "foo",
                      "params": {
                        "filters": "brand:adidas"
                      }
                    }
                  },
                  "position": 2,
                  "length": 1,
                  "metadata": {
                    "hits": {
                      "addItemKey": true,
                      "extra": {
                        "my-string": "string",
                        "my-bool": true,
                        "my-number": 42,
                        "my-object": {
                          "sub-key": "sub-value"
                        }
                      }
                    }
                  }
                }
              ]
            }
          }
        }
      }
    },
    "request": {
      "path": "/1/compositions/compositionID/rules/rule-with-metadata",
      "method": "PUT",
      "body": {
        "objectID": "rule-with-metadata",
        "conditions": [
          {
            "anchoring": "is",
            "pattern": "test"
          }
        ],
        "consequence": {
          "behavior": {
            "injection": {
              "main": {
                "source": {
                  "search": {
                    "index": "foo"
                  }
                }
              },
              "injectedItems": [
                {
                  "key": "my-unique-group-from-rule-key",
                  "source": {
                    "search": {
                      "index": "foo",
                      "params": {
                        "filters": "brand:adidas"
                      }
                    }
                  },
                  "position": 2,
                  "length": 1,
                  "metadata": {
                    "hits": {
                      "addItemKey": true,
                      "extra": {
                        "my-string": "string",
                        "my-bool": true,
                        "my-number": 42,
                        "my-object": {
                          "sub-key": "sub-value"
                        }
                      }
                    }
                  }
                }
              ]
            }
          }
        }
      }
    }
  },
  {
    "parameters": {
      "compositionID": "compositionID",
      "objectID": "rule-with-exernal-source",
      "compositionRule": {
        "objectID": "rule-with-exernal-source",
        "description": "my description",
        "tags": ["tag1", "tag2"],
        "enabled": true,
        "validity": [
          {
            "from": 1704063600,
            "until": 1704083600
          }
        ],
        "conditions": [
          {
            "anchoring": "contains",
            "pattern": "harry"
          },
          {
            "anchoring": "contains",
            "pattern": "potter"
          }
        ],
        "consequence": {
          "behavior": {
            "injection": {
              "main": {
                "source": {
                  "search": {
                    "index": "my-index",
                    "params": {
                      "filters": "brand:adidas"
                    }
                  }
                }
              },
              "injectedItems": [
                {
                  "key": "my-unique-external-group-from-rule-key",
                  "source": {
                    "external": {
                      "index": "my-index",
                      "params": {
                        "filters": "brand:adidas"
                      },
                      "ordering": "userDefined"
                    }
                  },
                  "position": 0,
                  "length": 3
                }
              ]
            }
          }
        }
      }
    },
    "request": {
      "path": "/1/compositions/compositionID/rules/rule-with-exernal-source",
      "method": "PUT",
      "body": {
        "objectID": "rule-with-exernal-source",
        "description": "my description",
        "tags": ["tag1", "tag2"],
        "enabled": true,
        "validity": [
          {
            "from": 1704063600,
            "until": 1704083600
          }
        ],
        "conditions": [
          {
            "anchoring": "contains",
            "pattern": "harry"
          },
          {
            "anchoring": "contains",
            "pattern": "potter"
          }
        ],
        "consequence": {
          "behavior": {
            "injection": {
              "main": {
                "source": {
                  "search": {
                    "index": "my-index",
                    "params": {
                      "filters": "brand:adidas"
                    }
                  }
                }
              },
              "injectedItems": [
                {
                  "key": "my-unique-external-group-from-rule-key",
                  "source": {
                    "external": {
                      "index": "my-index",
                      "params": {
                        "filters": "brand:adidas"
                      },
                      "ordering": "userDefined"
                    }
                  },
                  "position": 0,
                  "length": 3
                }
              ]
            }
          }
        }
      }
    }
  },
  {
    "parameters": {
      "compositionID": "compositionID",
      "objectID": "rule-with-deduplication",
      "compositionRule": {
        "objectID": "rule-with-deduplication",
        "description": "my description",
        "enabled": true,
        "conditions": [
          {
            "anchoring": "contains",
            "pattern": "harry"
          }
        ],
        "consequence": {
          "behavior": {
            "injection": {
              "main": {
                "source": {
                  "search": {
                    "index": "my-index"
                  }
                }
              },
              "injectedItems": [
                {
                  "key": "my-unique-injected-item-key",
                  "source": {
                    "search": {
                      "index": "my-index"
                    }
                  },
                  "position": 0,
                  "length": 3
                }
              ],
              "deduplication": {
                "positioning": "highestInjected"
              }
            }
          }
        }
      }
    },
    "request": {
      "path": "/1/compositions/compositionID/rules/rule-with-deduplication",
      "method": "PUT",
      "body": {
        "objectID": "rule-with-deduplication",
        "description": "my description",
        "enabled": true,
        "conditions": [
          {
            "anchoring": "contains",
            "pattern": "harry"
          }
        ],
        "consequence": {
          "behavior": {
            "injection": {
              "main": {
                "source": {
                  "search": {
                    "index": "my-index"
                  }
                }
              },
              "injectedItems": [
                {
                  "key": "my-unique-injected-item-key",
                  "source": {
                    "search": {
                      "index": "my-index"
                    }
                  },
                  "position": 0,
                  "length": 3
                }
              ],
              "deduplication": {
                "positioning": "highestInjected"
              }
            }
          }
        }
      }
    }
  }
]
