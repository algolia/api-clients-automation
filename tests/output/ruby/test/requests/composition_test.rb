# Code generated by OpenAPI Generator (https://openapi-generator.tech), manual changes will be lost - read more on https://github.com/algolia/api-clients-automation. DO NOT EDIT.
require "algolia"
require "test/unit"

class TestCompositionClient < Test::Unit::TestCase
  def setup
    @client = Algolia::CompositionClient.create(
      "APP_ID",
      "API_KEY",

      {requester: Algolia::Transport::EchoRequester.new}
    )
  end

  # search
  def test_search
    req = @client.search_with_http_info(
      "foo",
      Algolia::Composition::RequestBody.new(params: Algolia::Composition::Params.new(query: "batman"))
    )

    assert_equal(:post, req.method)
    assert_equal("/1/compositions/foo/run", req.path)
    assert_equal({}.to_a, req.query_params.to_a)
    assert(({}.to_a - req.headers.to_a).empty?, req.headers.to_s)
    assert_equal(JSON.parse("{\"params\":{\"query\":\"batman\"}}"), JSON.parse(req.body))
  end

  # searchForFacetValues
  def test_search_for_facet_values
    req = @client.search_for_facet_values_with_http_info(
      "foo",
      "brand",
      Algolia::Composition::SearchForFacetValuesRequest.new(
        params: Algolia::Composition::SearchForFacetValuesParams.new(max_facet_hits: 10)
      )
    )

    assert_equal(:post, req.method)
    assert_equal("/1/compositions/foo/facets/brand/query", req.path)
    assert_equal({}.to_a, req.query_params.to_a)
    assert(({}.to_a - req.headers.to_a).empty?, req.headers.to_s)
    assert_equal(JSON.parse("{\"params\":{\"maxFacetHits\":10}}"), JSON.parse(req.body))
  end

end
