// Code generated by OpenAPI Generator (https://openapi-generator.tech), manual changes will be lost
// - read more on https://github.com/algolia/api-clients-automation. DO NOT EDIT.
package com.algolia.benchmark

import com.algolia.client.api.SearchClient
import com.algolia.client.configuration.*
import com.algolia.client.extensions.*
import com.algolia.client.model.search.*
import com.algolia.client.transport.*
import com.algolia.utils.*
import io.ktor.http.*
import kotlin.test.*
import kotlinx.coroutines.test.*
import kotlinx.serialization.json.*

class SearchTest {

  @Test
  fun `benchmark the search method`() = runTest {
    val client =
      SearchClient(
        appId = "test-app-id",
        apiKey = "test-api-key",
        options =
          ClientOptions(
            hosts =
              listOf(
                Host(
                  url = if (System.getenv("CI") == "true") "localhost" else "host.docker.internal",
                  protocol = "http",
                  port = 6682,
                )
              )
          ),
      )
    for (i in 1..2000) {

      client.runTest(
        call = {
          search(
            searchMethodParams =
              SearchMethodParams(
                requests =
                  listOf(
                    SearchForHits(
                      indexName = "cts_e2e_benchmark_search_kotlin",
                      query = "iphone 15 pro max 512gb",
                      hitsPerPage = 50,
                    )
                  )
              )
          )
        },
        intercept = {},
      )
    }
  }
}
