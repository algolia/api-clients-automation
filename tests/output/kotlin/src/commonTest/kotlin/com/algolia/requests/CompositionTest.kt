// Code generated by OpenAPI Generator (https://openapi-generator.tech), manual changes will be lost - read more on https://github.com/algolia/api-clients-automation. DO NOT EDIT.
package com.algolia.requests

import com.algolia.client.api.CompositionClient
import com.algolia.client.configuration.*
import com.algolia.client.model.composition.*
import com.algolia.client.model.composition.RequestBody
import com.algolia.client.transport.*
import com.algolia.utils.*
import io.ktor.http.*
import kotlinx.coroutines.test.*
import kotlinx.serialization.json.*
import kotlin.test.*

class CompositionTest {

  val client = CompositionClient(
    appId = "appId",
    apiKey = "apiKey",
  )

  // search

  @Test
  fun `search`() = runTest {
    client.runTest(
      call = {
        search(
          compositionID = "foo",
          requestBody = RequestBody(
            params = Params(
              query = "batman",
            ),
          ),
        )
      },
      intercept = {
        assertEquals("/1/compositions/foo/run".toPathSegments(), it.url.pathSegments)
        assertEquals(HttpMethod.parse("POST"), it.method)
        assertJsonBody("""{"params":{"query":"batman"}}""", it.body)
      },
    )
  }

  // searchForFacetValues

  @Test
  fun `searchForFacetValues`() = runTest {
    client.runTest(
      call = {
        searchForFacetValues(
          compositionID = "foo",
          facetName = "brand",
          searchForFacetValuesRequest = SearchForFacetValuesRequest(
            params = SearchForFacetValuesParams(
              maxFacetHits = 10,
            ),
          ),
        )
      },
      intercept = {
        assertEquals("/1/compositions/foo/facets/brand/query".toPathSegments(), it.url.pathSegments)
        assertEquals(HttpMethod.parse("POST"), it.method)
        assertJsonBody("""{"params":{"maxFacetHits":10}}""", it.body)
      },
    )
  }
}
