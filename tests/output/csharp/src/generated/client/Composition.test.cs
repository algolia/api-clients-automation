// Code generated by OpenAPI Generator (https://openapi-generator.tech), manual changes will be lost - read more on https://github.com/algolia/api-clients-automation. DO NOT EDIT.
using System.Text.Json;
using System.Text.RegularExpressions;
using Algolia.Search.Clients;
using Algolia.Search.Http;
using Algolia.Search.Models.Common;
using Algolia.Search.Models.Composition;
using Algolia.Search.Serializer;
using Algolia.Search.Tests.Utils;
using Algolia.Search.Transport;
using Quibble.Xunit;
using Xunit;

namespace Algolia.Search.client;

public class CompositionClientTests
{
  private readonly EchoHttpRequester _echo;
  private Exception _ex;

  public CompositionClientTests()
  {
    _echo = new EchoHttpRequester();
  }

  [Fact]
  public void Dispose() { }

  [Fact(DisplayName = "calls api with correct read host")]
  public async Task ApiTest0()
  {
    var client = new CompositionClient(new CompositionConfig("test-app-id", "test-api-key"), _echo);

    await client.SearchAsync<Hit>("test-composition-id", new RequestBody { });
    EchoResponse result = _echo.LastResponse;

    Assert.Equal("test-app-id-dsn.algolia.net", result.Host);
  }

  [Fact(DisplayName = "calls api with correct write host")]
  public async Task ApiTest1()
  {
    var client = new CompositionClient(new CompositionConfig("test-app-id", "test-api-key"), _echo);

    await client.SearchAsync<Hit>("test-composition-id", new RequestBody { });
    EchoResponse result = _echo.LastResponse;

    Assert.Equal("test-app-id-dsn.algolia.net", result.Host);
  }
}
