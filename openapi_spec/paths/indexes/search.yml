post:
  tags:
    - search
  operationId: search
  summary: Get search results
  parameters:
    - $ref: '../../parameters.yml#/IndexName'
  requestBody:
    required: true
    content:
      application/json:
        schema:
          $ref: ../../schemas/SearchParams.yml
  responses:
    '200':
      description: OK
      content:
        application/json:
          schema:
            title: singleQueryResponse
            type: object
            additionalProperties: false
            properties:
              abTestID:
                type: integer
                description: If a search encounters an index that is being A/B tested, abTestID reports the ongoing A/B test ID.
              abTestVariantID:
                type: integer
                description: If a search encounters an index that is being A/B tested, abTestVariantID reports the variant ID of the index used.
              aroundLatLng:
                type: string
                description: The computed geo location.
                pattern: ^(-?\d+(\.\d+)?),\s*(-?\d+(\.\d+)?)$
              automaticRadius:
                type: string
                description: The automatically computed radius. For legacy reasons, this parameter is a string and not an integer.
              exhaustiveFacetsCount:
                type: boolean
                description: Whether the facet count is exhaustive or approximate.
              exhaustiveNbHits:
                type: boolean
                description: Indicate if the nbHits count was exhaustive or approximate
              exhaustiveTypo:
                type: boolean
                description: Indicate if the typo-tolerence search was exhaustive or approximate (only included when typo-tolerance is enabled)
              facets:
                type: object
                additionalProperties:
                  type: object
                  additionalProperties:
                    type: string
                description: A mapping of each facet name to the corresponding facet counts.
                example:
                  facets:
                    category:
                      food: 1
                      tech: 42
              facets_stats:
                type: object
                description: Statistics for numerical facets.
                queryID:
                  $ref: ../../responses/common.yml#/queryID
              hits:
                type: array
                items:
                  $ref: ../../schemas/Record.yml#/record
              hitsPerPage:
                $ref: ../../schemas/SearchParams.yml#/properties/hitsPerPage
              index:
                type: string
                example: indexName
              indexUsed:
                type: string
                description: Index name used for the query. In the case of an A/B test, the targeted index isnâ€™t always the index used by the query.
              message:
                type: string
                description: Used to return warnings about the query.
              nbHits:
                type: integer
                description: Number of hits that the search query matched
                example: 20
              nbPages:
                type: integer
                description: Number of pages available for the current query
                example: 1
              nbSortedHits:
                type: integer
                description: The number of hits selected and sorted by the relevant sort algorithm
              page:
                $ref: ../../schemas/SearchParams.yml#/properties/page
              params:
                type: string
                description: A url-encoded string of all search parameters.
                example: query=a&hitsPerPage=20
              parsedQuery:
                type: string
                description: The query string that will be searched, after normalization.
              processingTimeMS:
                type: number
                description: Time the server took to process the request, in milliseconds.
                example: 20
              query:
                $ref: ../../schemas/SearchParams.yml#/properties/query
              queryAfterRemoval:
                type: string
                description: A markup text indicating which parts of the original query have been removed in order to retrieve a non-empty result set.
              serverUsed:
                type: string
                description: Actual host name of the server that processed the request.
              userData:
                $ref: ../../schemas/SearchParams.yml#/properties/userData

    # Other codes
    '400':
      $ref: '../../responses/BadRequest.yml'
    '404':
      $ref: '../../responses/IndexNotFound.yml'
